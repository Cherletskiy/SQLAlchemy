
# Python и БД. ORM

Этот скрипт реализует управление базой данных для книжного магазина с использованием SQLAlchemy и SQLite. Он позволяет добавлять тестовые данные в базу и выполнять запросы о продажах книг для конкретного издателя.

## Требования
Убедитесь, что у вас установлены следующие компоненты:
- Python 3.x
- SQLAlchemy
- Библиотека `tabulate` для форматированного вывода таблиц

Для установки необходимых зависимостей выполните команду:
```bash
pip install -r requirements.txt
```



## Возможности
- **Добавление тестовых данных** в базу данных из JSON-файла.
- **Запрос данных о продажах** книг для конкретного издателя.

## Описание работы

### Файл `models.py`
В этом файле содержится описание моделей базы данных:

- `Publisher` — таблица издателей.
- `Book` — таблица книг.
- `Shop` — таблица магазинов.
- `Stock` — связь между книгами и магазинами.
- `Sale` — информация о продажах.

Также в этом файле находится функция для создания таблиц в базе данных — `create_tables()`.

### Функции

#### `add_test_data(file: str) -> None`
Функция для добавления тестовых данных в базу. Она читает JSON-файл и добавляет объекты в соответствующие таблицы базы данных. Формат JSON-файла должен быть следующим:

```json
[
  {
    "model": "book", 
    "pk": 1,
    "fields": {
      "title": "Название книги", 
      "id_publisher": 1
    }
  },
  ...
]
```

Пример использования:
```python
add_test_data("tests_data.json")
```

#### `get_sale_data() -> None`
Функция, которая запрашивает у пользователя имя или идентификатор издателя и выводит данные о продажах книг этого издателя. Результат отображается в виде таблицы с информацией о названии книги, магазине, цене и дате продажи.

Пример использования:
```bash
Укажите имя или идентификатор издателя (publisher): "Название издателя"
```

## Запуск скрипта
1. Убедитесь, что файл базы данных SQLite (db.db) существует.
2. Для добавления тестовых данных раскомментируйте и вызовите функцию `add_test_data("tests_data.json")`.
3. Запустите main.py и укажите данные для получения информации о продажах.


### Пример вывода
После ввода имени или идентификатора издателя вывод будет выглядеть как таблица:

```
+-------------------+-----------+--------+------------+
| Название книги    | Магазин   | Цена   | Дата       |
+-------------------+-----------+--------+------------+
| Книга 1           | Магазин 1 | 20.99  | 2025-01-01 |
| Книга 2           | Магазин 2 | 15.49  | 2025-01-05 |
+-------------------+-----------+--------+------------+
```
